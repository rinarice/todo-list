{% extends "base.html" %}

{% block content %}
  <h1>To-Do List</h1>
  <a href="{% url 'tasks:task-add' %}" class="btn btn-primary mb-3">Add New
    Task</a>
  <table class="table table-striped">
    <thead>
    <tr>
      <th>Task</th>
      <th>Created At</th>
      <th>Deadline</th>
      <th>Tags</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    {% for task in task_list %}
      <tr>
        <td>{{ task.content }}</td>
        <td>{{ task.created_at }}</td>
        <td>{{ task.deadline }}</td>
        <td>
          {% for tag in task.tags.all %}
            <span class="badge badge-secondary">{{ tag.name }}</span>
          {% endfor %}
        </td>
        <td>
          {% if task.status %}
            <span class="badge badge-success">Done</span>
          {% else %}
            <span class="badge badge-warning">Not Done</span>
          {% endif %}
        </td>
        <td>
          <a href="{% url 'tasks:task-update' task.pk %}"
             class="btn btn-sm btn-warning">Edit</a>
          <a href="{% url 'tasks:task-delete' task.pk %}"
             class="btn btn-sm btn-danger">Delete</a>
          <form action="{% url 'tasks:task-toggle' task.pk %}" method="post"
                style="display:inline;">
            {% csrf_token %}
            {% if task.status %}
              <button class="btn btn-sm btn-secondary">Undo</button>
            {% else %}
              <button class="btn btn-sm btn-success">Complete</button>
            {% endif %}
          </form>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
{% endblock %}
